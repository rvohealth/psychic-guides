---
sidebar_position: 2
---

# dream

Since dream is an independent library that is imported by psychic, we expose configuration for you which enables dream to understand, for example, what your database credentials are, or where you want your database migrations to go. These configuration items are spread into two files. The first, which is an optional file that can be included at the root of your api folder, is the `.dream.yml` file.

## .dream.yml

The .dream.yml file is entirely concerned with defining the paths to various folders. This file is optional, and each item on here will implicitly fall back to the default location within a psychic app. Generally speaking, you shouldn't need to make changes to this file.

```yaml
// api/.dream.yml
models_path: 'src/app/models'
serializers_path: 'src/app/serializers'
client_api_schema_path: '../client/src/app/api/schema.ts'
conf_path: 'src/conf'
db_path: 'src/db'
unit_spec_path: 'spec/unit'
```

A second configuration file is also used in dream, and can be found at the `conf/dream.ts` location. This file is concerned with provisioning your dream application with database credentials, primary key types, etc...

```ts
// conf/dream.ts
import { Dreamconf } from '../../../src'

export default function configureDream(dreamconf: Dreamconf) {
  dreamconf.set('primaryKeyType', 'bigserial')

  dreamconf.set('dbCredentials', {
    primary: {
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      host: process.env.PRIMARY_DB_HOST!,
      name: process.env.PRIMARY_DB_NAME!,
      port: parseInt(process.env.DB_PORT!),
      useSsl: process.env.DB_USE_SSL === '1',
    },
    replica: {
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      host: process.env.REPLICA_DB_HOST!,
      name: process.env.REPLICA_DB_NAME!,
      port: parseInt(process.env.DB_PORT!),
      useSsl: process.env.DB_USE_SSL === '1',
    },
  })
}
```

Additionally, a base model (called `ApplicationModel`) is pre-established for you which contains carefully constructed type bindings to bridge the types generated by kysely throughout our app through each of your models. This happens automatically for you, but it must be the base class for each of your models in order for the type safety of our system to work properly.

```ts
import { Dream, Dreamconf } from '@rvohealth/dream'
import { AllColumns, DBClass } from '../../db/sync'
import { schema } from '../../db/schema'
import dreamconf from '../../conf/dreamconf'

export default class ApplicationModel extends Dream {
  public get DB() {
    return new DBClass()
  }

  public get allColumns(): typeof AllColumns {
    return AllColumns
  }

  public get dreamconf(): Dreamconf<DBClass, typeof schema> {
    return dreamconf
  }
}
```
