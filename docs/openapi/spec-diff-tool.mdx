---
pagination_next: null
---
---
sidebar_position: 7
pagination_next: null
ai_summary: OpenAPI spec diff tool automatically detects breaking and non-breaking changes between current branch and HEAD. Requires oasdiff installation and checkDiffs: true in OpenAPI config. Runs automatically on psy sync or manually via psy diff:openapi. Supports --fail-on-breaking flag.
---

import PackageManagerTabs from '@site/src/components/ui/package-manager-tabs'

## OpenAPI Spec Diff Tool

This tool helps developers automatically detect **breaking** and **non-breaking** changes between the current OpenAPI specification(s) in your branch and the `HEAD` branch (e.g., `main`). It uses [`oasdiff`](https://github.com/Tufin/oasdiff) under the hood.

It's designed to integrate easily into your existing workflows, either automatically or on-demand.

## Prerequisites

[`oasdiff`](https://github.com/Tufin/oasdiff) **must be installed** and available on your local system or CI environment:


```bash
brew tap oasdiff/homebrew-oasdiff
brew install oasdiff
```

or 

```bash
# Install oasdiff
go install github.com/Tufin/oasdiff@latest
```


Your project must be configured using a `PsychicApp` where `checkDiffs: true` is enabled for any OpenAPI configuration you'd like to compare.

## Usage

Once `checkDiffs: true` is set in your OpenAPI config, there are two ways to run the diff tool:

### Automatic check

<PackageManagerTabs
  code={`{{PM}} psy sync`}
/>

- Automatically runs OpenAPI diff checks for all configs that have `checkDiffs: true`.
- Recommended for use in CI pipelines or as part of your standard sync process.

### Manual check

<PackageManagerTabs
  code={`{{PM}} psy diff:openapi`}
/>

- Manually triggers the diff comparison for enabled OpenAPI configs.
- Useful during development or pre-PR review.

## Fail on Breaking Changes

Use the `--fail-on-breaking`, or `-f` flag to **fail the command** if any breaking changes are detected:

<PackageManagerTabs
  code={`# when running sync
{{PM}} psy sync --fail-on-breaking

# when running directly
{{PM}} psy diff:openapi --fail-on-breaking`}
/>

- This will throw an error and exit the process if breaking changes are found compared to the `HEAD` branch (usually `main`).

## What It Compares

For each OpenAPI config:

- Fetches the OpenAPI spec from the `HEAD` branch (e.g., `main`)
- Compares it with the spec in your current working branch
- Uses `oasdiff` to generate:
  - A list of **breaking changes**
  - A **changelog** of all changes

## Output Summary

The CLI output will include:

- ‚úÖ **No changes** ‚Äî when files match
- üö® **Breaking changes** ‚Äî highlighted in red
- üìã **Changelog** ‚Äî a detailed diff of modifications

### Example Output

```bash
üîç Comparing current OpenAPI Specs against main...

‚úÖ openapi: No changes

============================================================
üìä Summary: All OpenAPI files in current branch are identical to main branch
============================================================
```

Or, with breaking changes:

```bash
üîç Comparing current OpenAPI Specs against main...

openapi: HAS CHANGES
   üö® BREAKING CHANGES:
      ‚Ä¢ response removed on GET /users
   üìã CHANGELOG:
      ‚Ä¢ Removed response from GET /users

============================================================
üö® CRITICAL: Breaking changes detected in current branch compared to main! Review before merging.
============================================================
```

### üìö Error Reference

| Error                                       | Description                                                              |
| ------------------------------------------- | ------------------------------------------------------------------------ |
| Fail on breaking                            | Thrown if `--fail-on-breaking` is used and breaking changes are detected |
| File not found                              | Raised if OpenAPI file is missing in the current working directory       |
| Git error                                   | Raised if file cannot be fetched from `HEAD` branch                      |
